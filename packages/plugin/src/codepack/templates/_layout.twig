{%- set demoArea = craft.app.request.segment(2) -%}
{%- set pageTemplate = craft.app.request.segment(3)|default('basic-light') -%}
{%- set pageTemplateFile = pageTemplate ~ '.twig' -%}
{%- if demoArea == "templates" -%}
    {%- set formHandle = craft.app.request.segment(4) -%}
{%- elseif demoArea in ["submissions", "custom"] -%}
    {%- set formHandle = craft.app.request.segment(3) -%}
    {%- set pageTemplateFile = null -%}
{%- endif -%}
{%- if formHandle -%}
    {%- set form = craft.freeform.form(formHandle, {
        formattingTemplate: pageTemplateFile,
    }) -%}
{%- endif -%}

<!doctype html>
<html lang="en"{% if pageTemplate == "bootstrap-5-dark" %} data-bs-theme="dark"{% endif %}>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>{{ pageTitle ? pageTitle : "Formatting Template Simulator" }} | Freeform Demo</title>
    <!-- Set Dark or Light Mode -->
    {% if pageTemplate in ["basic-dark", "bootstrap-5-dark", "conversational"] %}
        {% set colorMode = "dark" %}
    {% else %}
        {% set colorMode = "light" %}
    {% endif %}
    {% if demoArea == "templates" and craft.app.request.segment(4) %}
        <!-- Is this a Bootstrap template -->
        {% if pageTemplate in ["bootstrap-5", "bootstrap-5-dark", "bootstrap-5-floating-labels", "bootstrap-5-multipage-all-fields"] %}
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
        {% endif %}
        <!-- Is this a Foundation template -->
        {% if pageTemplate == "foundation-6" %}
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/css/foundation.min.css" crossorigin="anonymous">
            <script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/js/foundation.min.js" crossorigin="anonymous"></script>
        {% endif %}
        <!-- Is this a Tailwind template -->
        {% if pageTemplate == "tailwind-3" %}
            <style>
                [type=checkbox],[type=file],[type=radio]{ margin: 0;}
                ul.menu .is-active{color:white;background:grey;}
            </style>
            <script src="https://cdn.tailwindcss.com/3.1.8"></script>
        {% endif %}
    {% endif %}
    <style>
        :root {
            --page-bg: #{% if colorMode == "dark" %}212529{% else %}ffffff{% endif %};
            --page-text: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            --nav-text: #{% if colorMode == "dark" %}959595{% else %}8a8a8a{% endif %};
            --nav-bg: {% if colorMode == "dark" %}rgb(19,22,24,0.85){% else %}rgb(232,232,232,0.85){% endif %};
            --nav-highlight: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            --nav-bg-hover: {% if colorMode == "dark" %}rgb(19,22,24,0.25){% else %}rgb(232,232,232,0.25){% endif %};
            --logo-glow: 0 0 7px 1px {% if colorMode == "dark" %}rgb(255,255,255,0.2){% else %}rgb(0,0,0,0.1){% endif %};
            --menu-bg: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            --menu-list-bg: #{% if colorMode == "dark" %}191c1f{% else %}f1f1f1{% endif %};
            --menu-list-border: 1px solid #{% if colorMode == "dark" %}252b31{% else %}c5c5c5{% endif %};
            --nav-button-bg: #{% if colorMode == "dark" %}3c474f{% else %}d0d0d0{% endif %};
            --nav-button-text: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            --nav-button-hover: #{% if colorMode == "dark" %}dfdfdf{% else %}dfdfdf{% endif %};
            --nav-button-active:  #{% if colorMode == "dark" %}dfdfdf{% else %}eeeeee{% endif %};
            --nav-dropdown-bg: #{% if colorMode == "dark" %}191c1f{% else %}f1f1f1{% endif %};
            --nav-dropdown-bg-hover: #{% if colorMode == "dark" %}252b31{% else %}dedede{% endif %};
            --nav-dropdown-text: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            --nav-dropdown-divider: 1px solid #{% if colorMode == "dark" %}252b31{% else %}c5c5c5{% endif %};
            --form-box-submissions: {% if colorMode == "dark" %}rgb(0,0,0,0.2){% else %}rgb(0,0,0,0.05){% endif %};
            --table-row-bg: #{% if colorMode == "dark" %}212529{% else %}ffffff{% endif %};
            --table-row-bg-alt: #{% if colorMode == "dark" %}3c474f{% else %}f3f3f3{% endif %};
            --table-head-bg: #{% if colorMode == "dark" %}3c474f{% else %}d0d0d0{% endif %};
            --table-head-bg-alt: #{% if colorMode == "dark" %}404b53{% else %}eeeeee{% endif %};
            --table-head-bg-alt2: #{% if colorMode == "dark" %}404b53{% else %}e3e3e3{% endif %};
        }
    </style>
    <link href="{{ siteUrl }}assets/demo/css/demo.css?{{ 'now'|date('U') }}" rel="stylesheet">

{% block headerCss %}{% endblock %}

</head>
<body{% if spamMode is defined and spamMode == true %} class="freeform-spam-mode"{% endif %}>

    {% macro pageTemplateItem(template, form) %}
        {% if template == "divider" %}
            <hr />
        {% else %}
            <a{% if craft.app.request.segment(3) == template %} class="active"{% endif %} href="{{ siteUrl }}demo/templates/{{ template }}/{{ form }}{% if craft.app.request.segment(5) == "edit" %}/edit/{{ craft.app.request.segment(6) }}{% endif %}">{{ template|title|replace({'-':' '}) }}</a>
        {% endif %}
    {% endmacro %}

    <div class="freeform-nav">
        <a href="{{ siteUrl }}demo/" class="freeform-logo">
            <img src="{{ siteUrl }}assets/demo/images/icon.svg" alt="Freeform Demo"><h1>Freeform Demo</h1>
        </a>
        {% if demoArea == "templates" %}
            This section {{ craft.app.request.segment(4) ? "has" : "will" }} automatically loaded the
            <div class="freeform-nav-dropdown">
                <span class="freeform-nav-button">
                    {{ pageTemplate ? pageTemplate|title|replace({'-':' '}) : 'Select a template...' }}
                </span>
                <div class="freeform-nav-dropdown-content">
                {% for pageTemplate in (["basic-light", "basic-dark", "basic-floating-labels", "conversational", "divider", "grid", "flexbox", "divider", "bootstrap-5", "bootstrap-5-dark", "bootstrap-5-floating-labels", "bootstrap-5-multipage-all-fields", "divider", "tailwind-3", "foundation-6"]) -%}
                    {{ _self.pageTemplateItem(pageTemplate, formHandle) }}
                {%- endfor %}
                </div>
            </div>
            formatting template for the
            <div class="freeform-nav-dropdown">
                <span class="freeform-nav-button{{ form.name is not defined ? " dropdown-glow"}}">
                    <div class="freeform-form-circle"{{ form.name is defined ? ' style=background:' ~ form.color : ' style=display:none' }}></div>{{ form.name is defined ? form.name : 'Select a form...' }}
                </span>
                <div class="freeform-nav-dropdown-content">
                {% set forms = craft.freeform.forms %}
                {% for form in forms %}
                    <a{{ formHandle == form.handle ? ' class="active"' }} href="{{ siteUrl }}demo/templates/{{ pageTemplate ? pageTemplate : 'basic-light' }}/{{ form.handle }}"><div class="freeform-form-circle" style="background: {{ form.color }}"></div>{{ form.name }}</a>
                {% endfor %}
                </div>
            </div>
            form.
        {% elseif demoArea == "submissions" %}
            {{ craft.app.request.segment(3) ? "Viewing" : "View" }} submissions for the
            <div class="freeform-nav-dropdown">
                <span class="freeform-nav-button{{ form.name is not defined ? " dropdown-glow"}}">
                    <div class="freeform-form-circle"{{ form.name is defined ? ' style=background:' ~ form.color : ' style=display:none' }}></div>{{ form.name is defined ? form.name : 'Select a form...' }}
                </span>
                <div class="freeform-nav-dropdown-content">
                {% set forms = craft.freeform.forms %}
                {% for form in forms %}
                    <a{{ formHandle == form.handle ? ' class="active"' }} href="{{ siteUrl }}demo/submissions/{{ form.handle }}"><div class="freeform-form-circle" style="background: {{ form.color }}"></div>{{ form.name }} ({{ craft.freeform.submissions({formId: form.id}).count }})</a>
                {% endfor %}
                </div>
            </div>
            form.
        {% elseif demoArea == "custom" %}
            This section {{ craft.app.request.segment(3) ? "has" : "will" }} automatically {% if craft.app.request.segment(3) %}loaded the <code>{{ form.formTemplate }}</code>{% else %}load the{% endif %} formatting template for the 
            <div class="freeform-nav-dropdown">
                <span class="freeform-nav-button{{ form.name is not defined ? " dropdown-glow"}}">
                    <div class="freeform-form-circle"{{ form.name is defined ? ' style=background:' ~ form.color : ' style=display:none' }}></div>{{ form.name is defined ? form.name : 'Select a form...' }}
                </span>
                <div class="freeform-nav-dropdown-content">
                {% set forms = craft.freeform.forms %}
                {% for form in forms %}
                    <a{{ formHandle == form.handle ? ' class="active"' }} href="{{ siteUrl }}demo/custom/{{ form.handle }}"><div class="freeform-form-circle" style="background: {{ form.color }}"></div>{{ form.name }} ({{ craft.freeform.submissions({formId: form.id}).count }})</a>
                {% endfor %}
                </div>
            </div>
            form. Consider forcing a
            <div class="freeform-nav-dropdown">
                <span class="freeform-nav-button">
                    {{ "sample template"|t('freeform') }}
                </span>
                <div class="freeform-nav-dropdown-content">
                {% for pageTemplate in (["basic-light", "basic-dark", "basic-floating-labels", "conversational", "divider", "grid", "flexbox", "divider", "bootstrap-5", "bootstrap-5-dark", "bootstrap-5-floating-labels", "bootstrap-5-multipage-all-fields", "divider", "tailwind-3", "foundation-6"]) -%}
                    {{ _self.pageTemplateItem(pageTemplate, formHandle) }}
                {%- endfor %}
                </div>
            </div>
            instead.
        {% else %}
        {% endif %}
        <div class="freeform-menu">
            <input id="freeform-menu-toggle" type="checkbox" />
            <label class="freeform-menu-hamburger" for="freeform-menu-toggle">
                <div class="top"></div>
                <div class="top-inner"></div>
                <div class="meat"></div>
                <div class="bottom-inner"></div>
                <div class="bottom"></div>
            </label>
            <div class="freeform-menu-list">
                <a href="{{ siteUrl }}demo/templates" class="{{ demoArea == 'templates' ? ' active' }}">Templates</a>
                <a href="{{ siteUrl }}demo/submissions" class="{{ demoArea == 'submissions' ? ' active' }}">Submissions</a>
                <a href="{{ siteUrl }}demo/custom" class="{{ demoArea == 'custom' ? ' active' }}">Custom</a>
                <a href="{{ siteUrl }}demo/extras" class="{{ siteUrl == 'extras' ? ' active' }}">Extras</a>
            </div>
        </div>
    </div>

    <div class="freeform-form-content">

{% block content %}{% endblock %}

    </div>

{% block footerJs %}{% endblock %}

</body>
</html>