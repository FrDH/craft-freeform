{% set pageTemplate = craft.app.request.segment(3) %}
{% set formHandle = craft.app.request.segment(4) %}
<!doctype html>
<html lang="en"{% if pageTemplate == "bootstrap-5-dark" %} data-bs-theme="dark"{% endif %}>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Formatting Template Simulator</title>
    <!-- Set Dark or Light Mode -->
    {% if pageTemplate in ["basic-dark", "bootstrap-5-dark", "conversational"] %}
        {% set colorMode = "dark" %}
    {% else %}
        {% set colorMode = "light" %}
    {% endif %}
    <!-- Is this a Bootstrap template -->
    {% if pageTemplate in ["bootstrap-5", "bootstrap-5-dark", "bootstrap-5-floating-labels", "bootstrap-5-multipage-all-fields"] %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    {% endif %}
    <!-- Is this a Foundation template -->
    {% if pageTemplate == "foundation-6" %}
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.5.3/css/foundation.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.5.3/js/foundation.min.js"></script>
    {% endif %}
    <!-- Is this a Tailwind template -->
    {% if pageTemplate == "tailwind-3" %}
        <style>
            [type=checkbox],[type=file],[type=radio]{ margin: 0;}
            ul.menu .is-active{color:white;background:grey;}
        </style>
        <script src="https://cdn.tailwindcss.com/3.1.8"></script>
    {% endif %}
    <style>
        /* Freeform Core Styles */
        html {
            background: #{% if colorMode == "dark" %}212529{% else %}ffffff{% endif %};
            padding: 0;
            margin: 0 auto;
        }
        body {
            padding: 0;
            margin: 0 auto;
        }
        .freeform-form-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Freeform Notices */
        .freeform-info-notice {
            font: 400 12px sans-serif;
            text-align: center;
            color: #{% if colorMode == "dark" %}959595{% else %}8a8a8a{% endif %};
            background: #{% if colorMode == "dark" %}131618{% else %}e8e8e8{% endif %};
            display: block;
            padding: 15px 15px;
            margin-bottom: 50px;
        }
        .freeform-info-notice code,
        .freeform-info-notice b,
        .freeform-info-notice a {
            color: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
        }
        .freeform-warning-notice {
            font: 400 12px sans-serif;
            text-align: center;
            color: #f8741b;
            background: #ffe5d4;
            border: 1px solid #f8741b;
            border-radius: 5px;
            padding: 20px 30px;
            position: absolute;
            top: 50%;
            left: 50%;
            margin-right: -50%;
            transform: translate(-50%, -50%);
        }
        .freeform-warning-notice a {
            color: #f8741b;
        }

        /* Freeform Info Button */
        .freeform-info-button {
            background-color: #{% if colorMode == "dark" %}3c474f{% else %}d0d0d0{% endif %};
            color: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            padding: 5px 8px;
            margin: 0 3px;
            font-size: 12px;
            text-decoration: none;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.5s;
        }
        .freeform-info-button:hover {
            color: #{% if colorMode == "dark" %}dfdfdf{% else %}dfdfdf{% endif %};
            background-color: #0d6efd;
        }

        /* Freeform Info Dropdown */
        .freeform-info-dropdown {
            position: relative;
            display: inline-block;
        }
        .freeform-info-dropdown-content {
            text-align: left;
            display: none;
            position: absolute;
            margin-top: 5px;
            margin-left: 3px;
            background-color: #{% if colorMode == "dark" %}191c1f{% else %}f1f1f1{% endif %};
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
            border-top-right-radius: 5px;
            min-width: 200px;
            box-shadow: 0px 0 10px 5px rgba(0,0,0,0.2);
            z-index: 1;
            transition: all 0.25s;
        }
        .freeform-info-dropdown-content a {
            font-size: 12px;
            color: #{% if colorMode == "dark" %}dfdfdf{% else %}4e4e4e{% endif %};
            padding: 7px 8px;
            text-decoration: none;
            display: block;
            transition: all 0.25s;
        }
        .freeform-info-dropdown-content a.active {
            color: #0d6efd;
        }
        .freeform-info-dropdown-content hr {
            margin: 3px 0;
            border: 0;
            border-top: 1px solid #{% if colorMode == "dark" %}252b31{% else %}c5c5c5{% endif %};
        }
        .freeform-info-dropdown-content a:hover {
            background-color: #{% if colorMode == "dark" %}252b31{% else %}dedede{% endif %};
        }
        .freeform-info-dropdown-content a:first-of-type:hover {
            border-top-right-radius: 5px;
        }
        .freeform-info-dropdown-content a:last-of-type:hover {
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
        }
        .freeform-info-dropdown:hover .freeform-info-dropdown-content {
            display: block;
        }
        .freeform-info-dropdown:hover .freeform-info-button {
            color: #{% if colorMode == "dark" %}dfdfdf{% else %}eeeeee{% endif %};
            background-color: #0d6efd;
            border-bottom-left-radius: 0px;
            border-bottom-right-radius: 0px;
        }
    </style>
</head>
<body>

{% set form = craft.freeform.form(formHandle, {
    formattingTemplate: pageTemplate ~ '.twig',
}) %}

{% if form %}

    {% macro pageTemplateItem(template, form) %}
        {% if template == "divider" %}
            <hr />
        {% else %}
            <a{% if craft.app.request.segment(3) == template %} class="active"{% endif %} href="{{ siteUrl }}demo/templates/{{ template }}/{{ form }}">{{ template|title|replace({'-':' '}) }}</a>
        {% endif %}
    {% endmacro %}

    <div class="freeform-info-notice">
        This page has automatically loaded the
        <div class="freeform-info-dropdown">
            <span class="freeform-info-button">{{ pageTemplate|title|replace({'-':' '}) }}</span>
            <div class="freeform-info-dropdown-content">
            {% for pageTemplate in (["basic-light", "basic-dark", "basic-floating-labels", "conversational", "divider", "grid", "flexbox", "divider", "bootstrap-5", "bootstrap-5-dark", "bootstrap-5-floating-labels", "bootstrap-5-multipage-all-fields", "divider", "tailwind-3", "foundation-6"]) -%}
                {{ _self.pageTemplateItem(pageTemplate, formHandle) }}
            {%- endfor %}
            </div>
        </div>
        formatting template for the
        <div class="freeform-info-dropdown">
            <span class="freeform-info-button">{{ form.name }}</span>
            <div class="freeform-info-dropdown-content">
            {% set forms = craft.freeform.forms({ limit: 5 }) %}
            {% for form in forms %}
                <a{{ formHandle == form.handle ? ' class="active"' }} href="{{ siteUrl }}demo/templates/{{ pageTemplate }}/{{ form.handle }}">{{ form.name }}</a>
            {% endfor %}
            </div>
        </div>
        form.
    </div>

    <div class="freeform-form-container">
        {{ form.render }}
    </div>

{% else %}

        <div class="freeform-warning-notice">
            Form with the handle <code>{{ formHandle }}</code> does not exist.<br /><br />
            ‚Üê <a href="{{ siteUrl }}demo/">Return to the demo area</a>
        </div>

{% endif %}

</body>
</html>